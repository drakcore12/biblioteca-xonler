<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/main.css">
    <title>Bibliotecas Xonler - Invitado</title>
</head>
<body>
    <!-- Header cargado dinámicamente -->
    <div id="guest-header"></div>

    <main class="container my-5">
        <section class="row">
            <div class="col-md-8">
                <h2>Bienvenido a la Red de Bibliotecas Xonler</h2>
                <p class="lead">Conectamos las bibliotecas de colegios para facilitar el acceso al conocimiento.</p>
                <p>Nuestra plataforma permite a estudiantes buscar y pedir prestados libros de cualquier biblioteca de la red. Para acceder al catálogo completo y realizar préstamos, necesitas iniciar sesión.</p>
                <div class="mt-4">
                    <a href="login.html" class="btn btn-primary me-2">Iniciar Sesión</a>
                    <a href="contacto.html" class="btn btn-outline-secondary">Contactar Soporte</a>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title">Acceso Rápido</h3>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item"><a href="login.html" class="text-decoration-none">Iniciar Sesión</a></li>
                            <li class="list-group-item"><a href="contacto.html" class="text-decoration-none">Contactar Soporte</a></li>
                            <li class="list-group-item"><a href="contacto.html" class="text-decoration-none">Información General</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="row mt-5">
            <div class="col-12">
                <h2>¿Por qué registrarse?</h2>
                <div class="row mt-3">
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h4 class="card-title">Acceso Completo</h4>
                                <p class="card-text">Explora todo el catálogo de libros disponibles en nuestra red de bibliotecas.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h4 class="card-title">Préstamos en Línea</h4>
                                <p class="card-text">Reserva y solicita préstamos de libros desde la comodidad de tu hogar.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-4">
                        <div class="card h-100">
                            <div class="card-body">
                                <h4 class="card-title">Historial Personal</h4>
                                <p class="card-text">Lleva un control de tus préstamos y libros favoritos.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="row mt-5">
            <div class="col-12 text-center">
                <div class="alert alert-info">
                    <h4>¿Eres nuevo en Xonler?</h4>
                    <p class="mb-3">Para acceder a todas las funcionalidades, necesitas crear una cuenta o iniciar sesión.</p>
                    <a href="login.html" class="btn btn-primary">Crear Cuenta / Iniciar Sesión</a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer cargado dinámicamente -->
    <div id="guest-footer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Scripts de la página principal -->
    <script type="module">
      import { requireAnon } from '../../js/common/guard.js';
      import { initIndexGuestPage, initVisualEffects } from '../../services/index-guest.services.js';
      import { loadGuestLayout } from '../../services/component-loader.services.js';
      
      // Función para inicializar la validación
      function boot() {
        requireAnon(); // si hay sesión, lo saca de la página pública
      }
      
      // Inicializar página cuando se carga
      document.addEventListener('DOMContentLoaded', async () => {
        console.log('Página principal cargada');
        
        // Cargar componentes de layout
        await loadGuestLayout('index');
        
        // Validar autenticación primero
        boot();
        
        // Inicializar funcionalidad básica
        initIndexGuestPage();
        
        // Inicializar efectos visuales
        initVisualEffects();
      });
      
      // Ejecutar cuando la página vuelve a ser visible (por si usan botón atrás)
      document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible') {
          requireAnon();
        }
      });
    </script>
</body>
</html>