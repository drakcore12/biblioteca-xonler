apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: biblioteca-xonler
data:
  # ============================================
  # Configuración de la Aplicación
  # ============================================
  NODE_ENV: "development"
  PORT: "3000"
  HOST: "0.0.0.0"
  FRONTEND_URL: "http://localhost:3000"
  
  # ============================================
  # Configuración de Base de Datos
  # ============================================
  # En Kubernetes, el host es el nombre del servicio
  DB_HOST: "postgresql-service"
  DB_PORT: "5432"
  DB_NAME: "xonler"
  DB_USER: "postgres"
  
  # Configuración del Pool de Conexiones
  DB_POOL_MAX: "20"
  DB_POOL_IDLE_TIMEOUT: "30000"
  DB_POOL_CONNECTION_TIMEOUT: "2000"
  
  # ============================================
  # Seguridad y Autenticación
  # ============================================
  JWT_EXPIRES_IN: "24h"
  JWT_ISSUER: "biblioteca-xonler"
  JWT_AUDIENCE: "biblioteca-users"
  BCRYPT_ROUNDS: "12"
  CORS_ORIGIN: "http://localhost:3000"
  
  # ============================================
  # Configuración de Logs
  # ============================================
  LOG_LEVEL: "info"
  LOG_ENCRYPTION: "false"
  LOG_ENCRYPTION_KEY: ""
  LOG_RETENTION_DAYS: "30"
  LOG_COMPRESSION: "true"
  
  # ============================================
  # Configuración de Encriptación
  # ============================================
  ENCRYPTION_KEY_DIR: "./secure"
  
  # ============================================
  # Configuración de Email (SMTP)
  # ============================================
  SMTP_HOST: ""
  SMTP_PORT: "587"
  SMTP_SECURE: "false"
  SMTP_USER: ""
  SMTP_FROM: ""
  
  # ============================================
  # Alertas y Monitoreo
  # ============================================
  ALERT_EMAIL: ""
  WEBHOOK_URL: ""
  MONITORING_INTERVAL: "30000"
  MONITORING_THRESHOLD_CPU: "0.8"
  MONITORING_THRESHOLD_MEMORY: "0.85"
  MONITORING_THRESHOLD_DISK: "0.9"
  MONITORING_THRESHOLD_RESPONSE_TIME: "1000"
  MONITORING_THRESHOLD_ERROR_RATE: "0.05"
  MONITORING_MAX_RESPONSE_TIMES: "1000"
  ALERT_THRESHOLD_FAILED_LOGINS: "5"
  ALERT_THRESHOLD_SUSPICIOUS: "3"
  ALERT_THRESHOLD_BLOCKED_IPS: "10"
  ALERT_THRESHOLD_ERROR_RATE: "0.1"
  ALERT_THRESHOLD_MEMORY: "0.9"
  ALERT_THRESHOLD_DISK: "0.85"
  ALERT_COOLDOWN_PERIOD: "300000"
  SERVER_NAME: "biblioteca-xonler"
  
  # ============================================
  # Configuración de Cookies
  # ============================================
  COOKIE_DOMAIN: ""
  
  # ============================================
  # Configuración SSL/TLS (Opcional)
  # ============================================
  # Nota: Los certificados SSL se manejan como Secrets
  # DB_SSL_CA, DB_SSL_CERT, DB_SSL_KEY están en secrets.yaml
  
  # ============================================
  # Configuración de Monitoreo (Prometheus + Grafana)
  # ============================================
  PROMETHEUS_PORT: "9090"
  POSTGRES_EXPORTER_PORT: "9187"
  GRAFANA_PORT: "3001"
  GRAFANA_ADMIN_USER: "admin"
  CADVISOR_PORT: "8080"
  
  # ============================================
  # Configuración de PostgreSQL
  # ============================================
  POSTGRES_DB: "xonler"
  POSTGRES_USER: "postgres"
  
  # ============================================
  # Configuración de Grafana
  # ============================================
  GF_USERS_ALLOW_SIGN_UP: "false"
  
  # ============================================
  # Configuración de pgAdmin
  # ============================================
  PGADMIN_DEFAULT_EMAIL: "admin@biblioteca-xonler.com"
  
  # ============================================
  # Configuración de Jenkins
  # ============================================
  JENKINS_PORT: "8080"
  JENKINS_AGENT_PORT: "50000"

  # ============================================
  # Configuración de SonarQube
  # ============================================
  SONAR_ES_BOOTSTRAP_CHECKS_DISABLE: "true"
  SONAR_JDBC_URL: "jdbc:postgresql://postgresql-service:5432/sonarqube"
  SONAR_JDBC_USERNAME: "sonar"

